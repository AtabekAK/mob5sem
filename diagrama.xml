<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn">
  <bpmn:collaboration id="Collaboration_1">
    <bpmn:participant id="Participant_User" name="Пользователь" processRef="Process_User" />
    <bpmn:participant id="Participant_App" name="Приложение" processRef="Process_App" />
    <bpmn:messageFlow id="Flow_1" sourceRef="Task_InputCredentials" targetRef="Task_ReceiveCredentials" />
    <bpmn:messageFlow id="Flow_2" sourceRef="Gateway_Validation" targetRef="Event_ShowError" />
    <bpmn:messageFlow id="Flow_3" sourceRef="Gateway_Validation" targetRef="Task_ShowMainScreen" />
  </bpmn:collaboration>
  <bpmn:process id="Process_User" isExecutable="false">
    <bpmn:startEvent id="Event_Start" name="Запускает приложение" />
    <bpmn:task id="Task_InputCredentials" name="Вводит логин и пароль" />
    <bpmn:intermediateCatchEvent id="Event_ShowError" name="Видит ошибку">
        <bpmn:messageEventDefinition id="MessageEventDefinition_Error" />
    </bpmn:intermediateCatchEvent>
    <bpmn:endEvent id="Event_End_User" name="Видит главный экран" />
    <bpmn:task id="Task_ShowMainScreen" name="Видит главный экран"/>
    <bpmn:sequenceFlow id="Flow_User_1" sourceRef="Event_Start" targetRef="Task_InputCredentials" />
    <bpmn:sequenceFlow id="Flow_User_2" sourceRef="Task_InputCredentials" targetRef="Event_ShowError" />
    <bpmn:sequenceFlow id="Flow_User_3" sourceRef="Event_ShowError" targetRef="Task_InputCredentials" />
  </bpmn:process>
  <bpmn:process id="Process_App" isExecutable="true">
    <bpmn:task id="Task_ReceiveCredentials" name="Получает данные" />
    <bpmn:task id="Task_Validate" name="Ищет пользователя в AsyncStorage" />
    <bpmn:exclusiveGateway id="Gateway_Validation" name="Данные верны?" />
    <bpmn:task id="Task_CreateSession" name="Создает активную сессию" />
    <bpmn:endEvent id="Event_End_App" name="Процесс завершен" />
    <bpmn:sequenceFlow id="Flow_App_1" sourceRef="Task_ReceiveCredentials" targetRef="Task_Validate" />
    <bpmn:sequenceFlow id="Flow_App_2" sourceRef="Task_Validate" targetRef="Gateway_Validation" />
    <bpmn:sequenceFlow id="Flow_App_3" name="Да" sourceRef="Gateway_Validation" targetRef="Task_CreateSession" />
    <bpmn:sequenceFlow id="Flow_App_4" name="Нет" sourceRef="Gateway_Validation" targetRef="Event_End_App" />
     <bpmn:sequenceFlow id="Flow_App_5" sourceRef="Task_CreateSession" targetRef="Event_End_App" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_1">
      <bpmndi:BPMNShape id="Participant_User_di" bpmnElement="Participant_User" isHorizontal="true">
        <dc:Bounds x="160" y="80" width="750" height="250" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_Start_di" bpmnElement="Event_Start">
        <dc:Bounds x="212" y="172" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="195" y="215" width="70" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_InputCredentials_di" bpmnElement="Task_InputCredentials">
        <dc:Bounds x="320" y="150" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_ShowError_di" bpmnElement="Event_ShowError">
        <dc:Bounds x="502" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="488" y="285" width="65" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
       <bpmndi:BPMNShape id="Task_ShowMainScreen_di" bpmnElement="Task_ShowMainScreen">
        <dc:Bounds x="660" y="150" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
       <bpmndi:BPMNEdge id="Flow_User_1_di" bpmnElement="Flow_User_1">
        <di:waypoint x="248" y="190" />
        <di:waypoint x="320" y="190" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_User_3_di" bpmnElement="Flow_User_3">
        <di:waypoint x="520" y="242" />
        <di:waypoint x="520" y="110" />
        <di:waypoint x="370" y="110" />
        <di:waypoint x="370" y="150" />
      </bpmndi:BPMNEdge>
       <bpmndi:BPMNShape id="Participant_App_di" bpmnElement="Participant_App" isHorizontal="true">
        <dc:Bounds x="160" y="380" width="750" height="250" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_ReceiveCredentials_di" bpmnElement="Task_ReceiveCredentials">
        <dc:Bounds x="260" y="460" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Validate_di" bpmnElement="Task_Validate">
        <dc:Bounds x="410" y="460" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_Validation_di" bpmnElement="Gateway_Validation" isMarkerVisible="true">
        <dc:Bounds x="555" y="475" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="544" y="532" width="73" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_CreateSession_di" bpmnElement="Task_CreateSession">
        <dc:Bounds x="660" y="460" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_End_App_di" bpmnElement="Event_End_App">
        <dc:Bounds x="822" y="482" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="811" y="525" width="58" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_App_1_di" bpmnElement="Flow_App_1">
        <di:waypoint x="360" y="500" />
        <di:waypoint x="410" y="500" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_App_2_di" bpmnElement="Flow_App_2">
        <di:waypoint x="510" y="500" />
        <di:waypoint x="555" y="500" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_App_3_di" bpmnElement="Flow_App_3">
        <di:waypoint x="605" y="500" />
        <di:waypoint x="660" y="500" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="626" y="482" width="13" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
       <bpmndi:BPMNEdge id="Flow_App_5_di" bpmnElement="Flow_App_5">
        <di:waypoint x="760" y="500" />
        <di:waypoint x="822" y="500" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1_di" bpmnElement="Flow_1">
        <di:waypoint x="370" y="230" />
        <di:waypoint x="310" y="460" />
      </bpmndi:BPMNEdge>
       <bpmndi:BPMNEdge id="Flow_App_4_di" bpmnElement="Flow_App_4">
        <di:waypoint x="580" y="475" />
        <di:waypoint x="580" y="420" />
        <di:waypoint x="520" y="420" />
        <di:waypoint x="520" y="278" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="548" y="380" width="23" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
       <bpmndi:BPMNEdge id="Flow_3_di" bpmnElement="Flow_3">
        <di:waypoint x="710" y="460" />
        <di:waypoint x="710" y="230" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>